
  
package com.yy.leetcodeplugin.temp.leetcode.editor.cn;

//2025-03-31 16:47:38 
//æœ€å¤§åŒ–åŸå¸‚çš„æœ€å°ç”µé‡

import java.util.Arrays;

public class MaximizeTheMinimumPoweredCity{
    public static void main(String[] args) {
         Solution solution = new MaximizeTheMinimumPoweredCity().new Solution();
        solution.maxPower(new int[]{1, 2, 4, 5, 0}, 1, 2);
    }
        //leetcode submit region begin(Prohibit modification and deletion)
class Solution {
            public long maxPower(int[] stations, int r, int k) {
                /**
                 * FIXME çœ‹çš„ç­”æ¡ˆ
                 *  å…ˆç”¨å‰ç¼€å’Œæ±‚æ¯ä¸ªåŸå¸‚çš„ç”µé‡
                 */
                int length = stations.length;

                //å…ˆæ±‚æ¯ä¸ªåŸå¸‚çš„ç”µé‡
                long[] sum = new long[length + 1];//FIXME: ä¸ºä»€ä¹ˆæ˜¯length+1? æ–¹ä¾¿å¤„ç†sum[0]
                for (int i = 0; i < length; i++) {
                    sum[i + 1] = sum[i] + stations[i];
                }

                long[] power = new long[length];
                //å‰ç¼€å’Œæ±‚æ¯ä¸ªåŸå¸‚çš„ç”µé‡
                for (int i = 0; i < length; i++) {
                    power[i] = sum[Math.min(length, i + r + 1)] - sum[Math.max(0, i - r)];
                }
                //å†ç”¨äºŒåˆ†æ³•æ±‚æœ€å°ç”µé‡çš„æœ€å¤§å€¼ã€‚å³åœ¨ç¡®ä¿æœ€å°ç”µé‡å¤§äºç­‰äºç»™å®štargetçš„æƒ…å†µä¸‹èƒ½å¦åšåˆ°æœ€å¤šåªå¢åŠ Kåº§ç”µç«™
                long left = 0;
                long right = (long) (Arrays.stream(stations).max().getAsInt() + k) * 2 * (r+1);//æœ€å¤§å€¼å–æ•´ä¸ªåŠå¾„èŒƒå›´å†…æ‰€æœ‰çš„ç”µç«™éƒ½è¾¾åˆ°æœ€å¤§å€¼
                long ans = 0;

                while (left <= right) {
                    long mid = left + (right - left) / 2;
                    if (check(power, mid, r, k)) {
                        ans = mid;
                        left = mid + 1;
                    } else {
                        right = mid - 1;
                    }
                }
                return ans;
            }

            /**
             * FIXME æ£€æŸ¥æ˜¯å¦èƒ½å¤Ÿåœ¨æœ€å¤šå»ºé€ Kåº§ç”µç«™çš„æƒ…å†µä¸‹è®©ç”µé‡æœ€å°å€¼éƒ½å¤§äºç­‰äºtarget
             *  æ€è·¯ï¼šä»ç¬¬ä¸€ä¸ªæˆåŸå¸‚å¼€å§‹ï¼Œè®©æ¯ä¸€ä¸ªåŸå¸‚çš„ç”µé‡éƒ½è¾¾åˆ°target,å¹¶ä¸”ç´¯è®¡éœ€è¦ä¿®å¤šå°‘ç”µç«™ã€‚ä¸€æ—¦éœ€è¦ä¿®çš„ç”µç«™è¶…è¿‡Kè¯´æ˜ä¸ç¬¦åˆæ¡ä»¶
             *
             *   è¿™é‡Œè¦ç”¨åˆ°çš„ä¸€ä¸ªæŠ€å·§æ˜¯ å·®åˆ†æ•°ç»„ã€‚å› ä¸ºæ¯æ¬¡æ–°å¢ç”µç«™éƒ½éœ€è¦æ›´æ–°åŠå¾„å†…çš„æ‰€æœ‰åŸå¸‚çš„ç”µé‡ï¼Œæ‰€ä»¥å¯¹äºè¿™ç§éœ€è¦é¢‘ç¹æ›´æ–°çš„åœºæ™¯ï¼Œå¯ä»¥ä½¿ç”¨
             *  å·®åˆ†æ•°ç»„çš„æ€æƒ³ï¼Œåªè®°å½•å˜åŒ–çš„å€¼ã€‚
             *  ä½†æ˜¯è¿™é‡Œä¸æ˜¯ç›´æ¥åº”ç”¨å·®åˆ†æ•°ç»„ï¼Œæœ‰ä¸€äº›å˜å½¢ã€‚
             */
            private boolean check(long[] power, long target, int r, int k) {
                int len = power.length;
                long[] diffArray = new long[len];
                long sumDiff = 0;//è®°å½•åŸå¸‚çš„ç”µé‡å€¼çš„å¢é‡
                long need = 0;
                for (int i = 0; i < len; i++) {
                    sumDiff += diffArray[i];

                    long diff = target - power[i] - sumDiff;

                    //FIXME
                    // è¯´æ˜éœ€è¦ä¿®ç”µç«™è¦†ç›–å½“å‰åŸå¸‚ï¼Œé‚£ä¹ˆå°±æŠŠç”µç«™ä¿®åœ¨ç¦»å½“å‰åŸå¸‚è·ç¦»ä¸ºrçš„åœ°æ–¹ï¼Œå¹¶ä¸”æ›´æ–°åŠå¾„èŒƒå›´å†…çš„æ‰€æœ‰ç”µé‡ã€‚
                    // æ³¨æ„è¿™é‡Œå¦‚æœç›´æ¥å»æ›´æ–°å€¼ä¼šæ¯”è¾ƒæ…¢ï¼Œæˆ‘ä»¬åªè¦è®°å½•ï¼ˆç´¯åŠ ï¼‰èŒƒå›´å†…æ‰€æœ‰åŸå¸‚çš„ç”µé‡çš„å¢åŠ å€¼å³å¯ã€‚
                    if (diff > 0) {
                        need += diff;
                        if (need > k) {//è¶…è¿‡Kå°±è¯´æ˜ä¸ç¬¦åˆæ¡ä»¶
                            return false;
                        }
                        sumDiff += diff;//ç´¯åŠ åŸå¸‚çš„ç”µé‡å€¼çš„å¢é‡
                        if(i + r + r + 1 < len) {
                            diffArray[i + r + r + 1] -= diff;//å·®åˆ†æ•°ç»„çš„æ€æƒ³ï¼Œç”µç«™å»ºåœ¨i+rå¤„ï¼Œè¦†ç›–åˆ°i+r+r,é‚£ä¹ˆ i+r+r+1å°±è¦å‡å»diff
                        }
                    }
                }
                return true;

            }
        }
//leetcode submit region end(Prohibit modification and deletion)

}

  //ç»™ä½ ä¸€ä¸ªä¸‹æ ‡ä» 0 å¼€å§‹é•¿åº¦ä¸º n çš„æ•´æ•°æ•°ç»„ stations ï¼Œå…¶ä¸­ stations[i] è¡¨ç¤ºç¬¬ i åº§åŸå¸‚çš„ä¾›ç”µç«™æ•°ç›®ã€‚ 
//
// æ¯ä¸ªä¾›ç”µç«™å¯ä»¥åœ¨ä¸€å®š èŒƒå›´ å†…ç»™æ‰€æœ‰åŸå¸‚æä¾›ç”µåŠ›ã€‚æ¢å¥è¯è¯´ï¼Œå¦‚æœç»™å®šçš„èŒƒå›´æ˜¯ r ï¼Œåœ¨åŸå¸‚ i å¤„çš„ä¾›ç”µç«™å¯ä»¥ç»™æ‰€æœ‰æ»¡è¶³ |i - j| <= r ä¸” 0
// <= i, j <= n - 1 çš„åŸå¸‚ j ä¾›ç”µã€‚ 
//
// 
// |x| è¡¨ç¤º x çš„ ç»å¯¹å€¼ ã€‚æ¯”æ–¹è¯´ï¼Œ|7 - 5| = 2 ï¼Œ|3 - 10| = 7 ã€‚ 
// 
//
// ä¸€åº§åŸå¸‚çš„ ç”µé‡ æ˜¯æ‰€æœ‰èƒ½ç»™å®ƒä¾›ç”µçš„ä¾›ç”µç«™æ•°ç›®ã€‚ 
//
// æ”¿åºœæ‰¹å‡†äº†å¯ä»¥é¢å¤–å»ºé€  k åº§ä¾›ç”µç«™ï¼Œä½ éœ€è¦å†³å®šè¿™äº›ä¾›ç”µç«™åˆ†åˆ«åº”è¯¥å»ºåœ¨å“ªé‡Œï¼Œè¿™äº›ä¾›ç”µç«™ä¸å·²ç»å­˜åœ¨çš„ä¾›ç”µç«™æœ‰ç›¸åŒçš„ä¾›ç”µèŒƒå›´ã€‚ 
//
// ç»™ä½ ä¸¤ä¸ªæ•´æ•° r å’Œ k ï¼Œå¦‚æœä»¥æœ€ä¼˜ç­–ç•¥å»ºé€ é¢å¤–çš„å‘ç”µç«™ï¼Œè¿”å›æ‰€æœ‰åŸå¸‚ä¸­ï¼Œæœ€å°ç”µé‡çš„æœ€å¤§å€¼æ˜¯å¤šå°‘ã€‚ 
//
// è¿™ k åº§ä¾›ç”µç«™å¯ä»¥å»ºåœ¨å¤šä¸ªåŸå¸‚ã€‚ 
//
// 
//
// ç¤ºä¾‹ 1ï¼š 
//
// 
//è¾“å…¥ï¼šstations = [1,2,4,5,0], r = 1, k = 2
//è¾“å‡ºï¼š5
//è§£é‡Šï¼š
//æœ€ä¼˜æ–¹æ¡ˆä¹‹ä¸€æ˜¯æŠŠ 2 åº§ä¾›ç”µç«™éƒ½å»ºåœ¨åŸå¸‚ 1 ã€‚
//æ¯åº§åŸå¸‚çš„ä¾›ç”µç«™æ•°ç›®åˆ†åˆ«ä¸º [1,4,4,5,0] ã€‚
//- åŸå¸‚ 0 çš„ä¾›ç”µç«™æ•°ç›®ä¸º 1 + 4 = 5 ã€‚
//- åŸå¸‚ 1 çš„ä¾›ç”µç«™æ•°ç›®ä¸º 1 + 4 + 4 = 9 ã€‚
//- åŸå¸‚ 2 çš„ä¾›ç”µç«™æ•°ç›®ä¸º 4 + 4 + 5 = 13 ã€‚
//- åŸå¸‚ 3 çš„ä¾›ç”µç«™æ•°ç›®ä¸º 5 + 4 = 9 ã€‚
//- åŸå¸‚ 4 çš„ä¾›ç”µç«™æ•°ç›®ä¸º 5 + 0 = 5 ã€‚
//ä¾›ç”µç«™æ•°ç›®æœ€å°‘æ˜¯ 5 ã€‚
//æ— æ³•å¾—åˆ°æ›´ä¼˜è§£ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿”å› 5 ã€‚
// 
//
// ç¤ºä¾‹ 2ï¼š 
//
// 
//è¾“å…¥ï¼šstations = [4,4,4,4], r = 0, k = 3
//è¾“å‡ºï¼š4
//è§£é‡Šï¼š
//æ— è®ºå¦‚ä½•å®‰æ’ï¼Œæ€»æœ‰ä¸€åº§åŸå¸‚çš„ä¾›ç”µç«™æ•°ç›®æ˜¯ 4 ï¼Œæ‰€ä»¥æœ€ä¼˜è§£æ˜¯ 4 ã€‚
// 
//
// 
//
// æç¤ºï¼š 
//
// 
// n == stations.length 
// 1 <= n <= 10âµ 
// 0 <= stations[i] <= 10âµ 
// 0 <= r <= n - 1 
// 0 <= k <= 10â¹ 
// 
//
// Related Topics è´ªå¿ƒ é˜Ÿåˆ— æ•°ç»„ äºŒåˆ†æŸ¥æ‰¾ å‰ç¼€å’Œ æ»‘åŠ¨çª—å£ ğŸ‘ 58 ğŸ‘ 0
